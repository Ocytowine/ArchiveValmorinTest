{
  "id": "mage",
  "name": "Mage",
  "description": "Lanceur d'art arcane basé sur l'intelligence",
  "ui_template": "mage.vue",
  "features": [
    {
      "id": "mage-traits",
      "type": "traits",
      "source": "mage",
      "priority": 70,
      "payload": {
        "hit_points": {
          "level_1": "6 + mod.CON",
          "per_level_after_1": "4 + mod.CON"
        },
        "proficiency_grant": {
          "armor": [],
          "weapons": [],
          "tools": []
        },
        "saving_throws": ["intelligence", "sagesse"]
      }
    },
    {
      "id": "mage_basics",
      "type": "spellcasting_feature",
      "source": "mage",
      "priority": 80,
      "payload": {
        "ability": "intelligence",
        "spell_save_dc_mod": "8 + mait + mod.INT",
        "spell_attack_mod": "mait + mod.INT",
        "spell_preparation_mod": "level_mage + mod.INT",
        "slots_table": { "0": "infinie", "1": 2 },
        "description": "Sorts connus et emplacements de mage niveau 1"
      }
    },
    {"id": "mage_items_initial",
      "type": "items_proposal",
      "source": "mage",
      "priority": 80,
      "payload": {
        "items": [
          { "id": "grimoire", "qty": 1 },
          { "id": "baton", "qty": 1 },
          { "id": "dague", "qty": 1 },
          { "id": "sacoche_composants", "qty": 1 },
          { "id": "robe", "qty": 1 }
        ]
      }
    },
    {
      "id": "mage_cantrips_initial",
      "type": "spell_grant",
      "source": "mage",
      "payload": {
        "spell_id": "lumiere",
        "level": 0,
        "known": true
      }
    },
    {
      "id": "mage_cantrips_initial_2",
      "type": "spell_grant",
      "source": "mage",
      "payload": {
        "spell_id": "mage_main",
        "level": 0,
        "known": true
      }
    },
    {
      "id": "mage_first_level_spells_start",
      "type": "spell_grant",
      "source": "mage",
      "payload": {
        "spell_id": "projectile_magique",
        "level": 1,
        "known": true
      }
    },
    {
      "id": "mage_first_level_shield",
      "type": "spell_grant",
      "source": "mage",
      "payload": {
        "spell_id": "bouclier",
        "level": 1,
        "known": true
      }
    },
    {
      "id": "mage_choice_school",
      "type": "choice",
      "source": "mage",
      "priority": 50,
      "conditions": {
        "all": [
          { "kind": "level_gte", "class": "mage", "value": 2 }
        ]
      },
      "payload": {
        "ui_id": "mage_subclass",
        "category": "subclasses",
        "choose": 1,
        "auto_from": {
          "collection": "subclasses",
          "filters": { "class_id": "mage" },
          "id_fields": ["id", "slug"],
          "label_fields": ["name", "nom"]
        }
      }
    },
    {
      "id": "mage_slots_up_to_5",
      "type": "spellcasting_feature",
      "source": "mage",
      "priority": 30,
      "conditions": {
        "all": [
          { "kind": "level_gte", "class": "mage", "value": 5 }
        ]
      },
      "payload": {
        "slots_table": { "1": 4, "2": 3, "3": 2 },
        "description": "Mise à jour des emplacements (mage niveau 5)"
      }
    },
    {
      "id": "mage_extra_spells_lv3_known",
      "type": "grant_feature",
      "source": "mage",
      "priority": 25,
      "conditions": {
        "all": [
          { "kind": "level_gte", "class": "mage", "value": 5 }
        ]
      },
      "payload": {
        "spell_id": "mage_known_fireball_lv3"
      }
    }
  ]
}
